package com.getgua.cms.services

/**
  * Created by likaili on 13/7/2016.
  */
import javax.inject.{Inject, Singleton}

import com.getgua.cms.daos._
import play.api.libs.concurrent.Execution.Implicits._
import play.api.Logger

@Singleton
class FeedsProducerService @Inject()(urlDao: UrlDao, cMSService: CMSService, editorUrlDao: EditorUrlDao) {

  val fake_users = Seq(1499,1509,1277,1609,1378,1945,1478,1259,1458,1914,1979,1552,1920,1480,1707,1532,1701,1293,1648,1525,1235,1220,1742,1923,1453,1433,1261,1855,1438,1567,1305,2040,1379,1871,1970,1422,1936,1195,1322,1504,1224,1865,1334,1403,1846,1614,1636,1257,1188,1404,1881,1760,1929,1679,1491,1477,1254,1518,1526,1632,1411,1954,1827,1975,1372,1926,1627,1912,1689,1485,1788,1857,1421,1743,1777,1492,1659,1819,1387,1981,1564,1667,1435,1523,1769,1357,1917,1383,1643,1418,1471,2009,1393,1587,1895,1303,1444,1776,1959,1958,1820,1557,1737,1196,1184,1434,1738,1755,1368,1209,1501,1957,1510,2035,1316,1228,1921,1349,1466,1758,1712,1482,1706,1191,1751,1767,1400,1745,1269,1942,1219,1436,1918,1437,1231,1596,1790,1307,1351,1723,1685,1515,1812,1762,1454,1527,1634,1823,1941,1867,1909,1447,1633,1590,1816,1885,1215,1719,1591,1782,1290,1800,1314,1242,1858,1569,1653,1754,1939,1575,1507,1429,1746,1905,1688,1439,1424,1536,1753,1597,1666,1442,1262,1724,1558,1682,1639,1386,2029,1838,1426,1611,1953,1620,1974,1446,1784,1946,1203,1804,1649,1489,1528,1494,2030,1522,1893,1860,1668,1508,2032,1244,1695,1628,1230,1664,1992,1698,1531,1323,1362,1530,1553,1370,1333,1687,1250,1572,1465,1875,1488,1907,1650,2037,1818,1217,1717,1249,1986,1644,1715,1705,1690,1560,1716,1985,1329,1574,1461,1392,1308,1850,2034,1626,1983,1529,1204,1185,1275,2019,1234,1186,1932,1304,1901,1849,1669,1731,1264,1662,1619,1982,1286,1398,1740,1778,1325,1703,1216,1450,1781,1815,1652,1265,1468,1665,1571,1493,1641,1969,1388,1950,1301,1832,1473,1930,1252,1534,1990,1810,1213,1647,2022,1987,1725,2001,1198,1995,1358,1539,1302,1884,1902,1338,1630,1341,1922,1756,1380,1415,1623,1629,1353,1408,1739,1795,1843,1289,1187,1276,1998,1736,1285,1369,1464,1805,1343,1476,1640,1556,1544,1365,1208,2000,1538,1828,1483,1570,1457,1646,1835,1673,1498,1240,1521,1355,1245,1808,1809,2013,1486,1520,1202,1394,2033,1876,1462,1268,1824,1282,1568,1973,1635,1680,1401,2023,1516,1935,1829,1318,1385,1943,1428,1396,1606,1577,1711,2010,1908,2005,1962,1311,1887,1505,1339,1994,1233,1566,1227,1246,1699,1359,1443,1456,1868,1192,1207,1205,1727,1225,1479,1581,1789,1997,1513,1263,1660,1330,1239,1189,1833,1312,1916,1497,1693,1292,1791,1710,1915,1366,1371,1375,1968,1211,1713,1582,1382,1467,1874,1845,1735,1729,1677,1714,1783,1934,1449,1610,1193,1291,1584,1237,1600,1288,1578,1672,2008,1761,1948,1726,1613,1888,1588,1315,1579,1785,1813,2031,1873,1459,1765,1317,1342,1616,1883,1624,1787,1199,1373,1586,1903,1708,1837,1255,1859,1475,2012,1413,1402,1440,1472,1278,1931,1427,1825,1533,1321,1750,1759,1692,1281,1514,1469,1502,1681,1545,1511,1856,1947,1993,1565,1487,2020,1354,1336,1786,1971,1559,1367,1625,1463,1896,1258,1503,1773,1691,1313,1272,1663,1774,1798,1655,1555,1441,1280,1585,1337,1965,1554,1741,1474,1802,1720,1384,1363,1279,1229,1324,2025,1961,1236,1879,1284,1657,1866,1910,1583,1637,1328,1549,1638,1226,1615,1599,1448,1608,1831,1661,1377,1345,2004,1702,1210,1256,1405,1683,1218,1412,1260,1940,2036,2027,1766,1542,1247,1967,1980,1780,1964,1840,1399,1963,1938,1593,1594,1801,1540,1425,1267,1768,1928,1414,1984,1889,1221,1927,1811,1604,1674,1551,1853,1200,1732,1704,1757,1364,1535,1297,1748,1966,1972,1274,1656,2212,1238,1807,1988,1201,1352,1432,1841,1223,1924,1273,1700,1546,1977,1900,1348,1839,1517,1548,1248,1911,1890,1197,1490,1844,1906,1310,1671,1991,1744,1880,1678,1496,1550,1675,1541,2016,1251,1416,1470,1709,1772,1897,1999,1878,1898,2026,1340,1847,1933,1676,1686,1978,1299,1891,1834,1190,1612,1862,2007,2002,1389,1406,1563,1814,1863,1356,1506,1347,1576,1524,2011,1602,1214,1346,1283,1822,1607,1821,1512,1621,1335,1892,1407,1730,1775,2021,1603,1654,1360,1397,1332,1376,1295,1622,1241,1296,1327,1420,1460,1770,2006,1645,1799,1598,1409,1794,1842,1561,1989,1562,1390,1960,1266,1580,1913,1684,1696,1956,1423,1519,1331,1817,1410,1270,1320,1605,1451,1361,1618,1872,1747,1374,1194,1792,1721,1294,1589,1951,1543,1694,1752,2015,1803,1848,1733,1864,1996,1718,1949,1796,1243,1232,1952,1919,1749,1484,1697,1206,1300,1395,2017,1417,1670,1797,1793,1592,1309,1319,1431,1537,2014,1925,2028,1326,1573,1869,1651,1826,1851,1253,1631,1779,1734,1830,1481,1306,1877,1658,1430,2003,1806,1854,1350,1861,1937,1287,1495,1344,1452,1955,1944,1976,1836,1722,1455,2018,1419,1852,1391,1728,1886,1212,1642,1222,1445,1617,1298,1271,1870,1882,1771,1894,2039,2038,1899,1500,1764,1381,2024,1595,1763,1601,1904)

  def submit = {
    //Logger.info("service submit")
    import scala.util.Random
    editorUrlDao.list.map{ eul =>
      println(eul.length)
      eul.map { eu =>
        val user_id = fake_users(Random.nextInt(fake_users.size))
        for {
          url_id <- cMSService.editor_submit(user_id, eu.url, eu.title, eu.description, eu.cover_url, eu.category, 1)
          _ <- editorUrlDao.submit(eu.id)
          _ <- urlDao.set_priority_property(url_id, eu.property, eu.priority)
        } yield url_id
      }
    }
  }
}
